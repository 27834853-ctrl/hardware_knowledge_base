<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æœ€ç»ˆæµ‹è¯• - LaTeX å…¬å¼éªŒè¯</title>
    <!-- MathJax é…ç½® -->
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']],
                processEscapes: true,
                processEnvironments: true
            },
            options: {
                skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre']
            }
        };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <style>
        body {
            font-family: "Microsoft YaHei", Arial, sans-serif;
            max-width: 1200px;
            margin: 20px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 10px;
            margin-bottom: 30px;
            text-align: center;
        }
        .test-box {
            background: white;
            padding: 20px;
            margin: 15px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .success {
            background: #d4edda;
            color: #155724;
            border: 2px solid #c3e6cb;
        }
        .error {
            background: #f8d7da;
            color: #721c24;
            border: 2px solid #f5c6cb;
        }
        .formula-box {
            background: #fff3cd;
            padding: 15px;
            margin: 10px 0;
            border-left: 4px solid #ffc107;
            border-radius: 5px;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ğŸ¯ LaTeX å…¬å¼æœ€ç»ˆæµ‹è¯•</h1>
        <p>ç›´æ¥ä» JS æ–‡ä»¶åŠ è½½å¹¶æµ‹è¯• LaTeX æ¸²æŸ“</p>
    </div>

    <div id="result"></div>

    <script src="high-speed-deep-dive-20260205-fixed.js"></script>
    <script>
        setTimeout(() => {
            const result = document.getElementById('result');
            let html = '';

            // æµ‹è¯• 1: æ£€æŸ¥ JS æ–‡ä»¶åŠ è½½
            if (typeof highSpeedDeepDive === 'undefined') {
                html += '<div class="test-box error"><h2>âŒ JS æ–‡ä»¶æœªåŠ è½½</h2></div>';
                result.innerHTML = html;
                return;
            }

            html += '<div class="test-box success"><h2>âœ… JS æ–‡ä»¶å·²åŠ è½½</h2></div>';

            // æµ‹è¯• 2: æ£€æŸ¥å†…å®¹é•¿åº¦
            const contentLength = highSpeedDeepDive.pcieTestingDeepDive.content.length;
            html += `<div class="test-box ${contentLength > 80000 ? 'success' : 'error'}">`;
            html += `<h2>${contentLength > 80000 ? 'âœ…' : 'âŒ'} å†…å®¹é•¿åº¦</h2>`;
            html += `<p><strong>å®é™…é•¿åº¦:</strong> ${contentLength} å­—ç¬¦</p>`;
            html += `<p><strong>çŠ¶æ€:</strong> ${contentLength > 80000 ? 'æ­£å¸¸' : 'å¼‚å¸¸ï¼ˆå¤ªçŸ­ï¼‰'}</p>`;
            html += '</div>';

            // æµ‹è¯• 3: æå–å¹¶æ¸²æŸ“å…¬å¼
            const content = highSpeedDeepDive.pcieTestingDeepDive.content;

            // æŸ¥æ‰¾é¢„åŠ é‡å…¬å¼
            const deEmphasisMatch = content.match(/De-emphasis[^$]*\$([^$]+)\$/);
            if (deEmphasisMatch) {
                html += '<div class="test-box">';
                html += '<h2>ğŸ“ é¢„åŠ é‡æ¯”è®¡ç®—å…¬å¼</h2>';
                html += '<div class="formula-box">';
                html += '<p><strong>LaTeX æºä»£ç :</strong></p>';
                html += `<pre>${deEmphasisMatch[1]}</pre>`;
                html += '<p><strong>æ¸²æŸ“ç»“æœ:</strong></p>';
                html += `<p>$${deEmphasisMatch[1]}$</p>`;
                html += '<p><strong>æ£€æŸ¥ç‚¹:</strong></p>';
                html += '<ul>';
                html += `<li>åŒ…å« \\times: ${deEmphasisMatch[1].includes('\\times') ? 'âœ…' : 'âŒ'}</li>`;
                html += `<li>åŒ…å« \\log: ${deEmphasisMatch[1].includes('\\log') ? 'âœ…' : 'âŒ'}</li>`;
                html += `<li>åŒ…å« \\frac: ${deEmphasisMatch[1].includes('\\frac') ? 'âœ…' : 'âŒ'}</li>`;
                html += `<li>åŒ…å« \\left å’Œ \\right: ${(deEmphasisMatch[1].includes('\\left') && deEmphasisMatch[1].includes('\\right')) ? 'âœ…' : 'âŒ'}</li>`;
                html += '</ul>';
                html += '</div>';
                html += '</div>';
            }

            // æŸ¥æ‰¾ BER å…¬å¼
            const berMatch = content.match(/BER[^$]*\$([^$]+)\$/);
            if (berMatch) {
                html += '<div class="test-box">';
                html += '<h2>ğŸ“ è¯¯ç ç‡ (BER) å…¬å¼</h2>';
                html += '<div class="formula-box">';
                html += `<p>$${berMatch[1]}$</p>`;
                html += '</div>';
                html += '</div>';
            }

            result.innerHTML = html;

            // ç­‰å¾… MathJax æ¸²æŸ“
            setTimeout(() => {
                const formulas = document.querySelectorAll('.formula-box p');
                let errorCount = 0;
                let successCount = 0;

                formulas.forEach((formula, index) => {
                    const text = formula.textContent;
                    if (text.includes('Math input error')) {
                        console.error(`âŒ å…¬å¼ ${index + 1} æ¸²æŸ“å¤±è´¥: Math input error`);
                        console.error(`   å†…å®¹: ${text.substring(0, 100)}`);
                        errorCount++;
                    } else if (text.includes('$')) {
                        console.warn(`âš ï¸  å…¬å¼ ${index + 1} æœªæ¸²æŸ“`);
                        console.warn(`   å†…å®¹: ${text.substring(0, 100)}`);
                    } else {
                        console.log(`âœ… å…¬å¼ ${index + 1} æ¸²æŸ“æˆåŠŸ`);
                        console.log(`   å†…å®¹: ${text.substring(0, 100)}`);
                        successCount++;
                    }
                });

                const summary = document.createElement('div');
                summary.className = `test-box ${errorCount === 0 ? 'success' : 'error'}`;
                summary.innerHTML = `
                    <h2>${errorCount === 0 ? 'ğŸ‰' : 'âŒ'} æ¸²æŸ“æ€»ç»“</h2>
                    <p><strong>æˆåŠŸ:</strong> ${successCount} ä¸ªå…¬å¼</p>
                    <p><strong>å¤±è´¥:</strong> ${errorCount} ä¸ªå…¬å¼</p>
                    <p><strong>ç»“è®º:</strong> ${errorCount === 0 ? 'LaTeX å…¬å¼å…¨éƒ¨æ­£ç¡®ï¼' : 'ä»æœ‰å…¬å¼æ¸²æŸ“é”™è¯¯'}</p>
                `;
                result.appendChild(summary);

                console.log('\n=== LaTeX å…¬å¼æµ‹è¯•å®Œæˆ ===');
                console.log('æˆåŠŸ:', successCount, 'å¤±è´¥:', errorCount);
            }, 3000);

        }, 1000);
    </script>
</body>
</html>
